<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Para el amor de mi vida 游눝</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container">

        <!-- FRASE INICIAL -->
        <div class="intro-text" id="introText">
            <p>
                Un detalle chiquito, para que sepas<br>
                que siempre busco la forma<br>
                de sacarte una sonrisa<br>
                y recordarte lo importante que sos para m칤.
            </p>
        </div>

        <!-- SOBRE -->
        <div class="envelope" id="sobre"></div>

        <div class="text">
            Toca para abrir <span class="heart">游눝</span>
        </div>

        <!-- CARTA -->
        <div class="carta" id="carta">
            <div class="contenido">
                <div id="mensaje"></div>

                <div id="fotos">
                    <img src="img/brisa1.jpeg" alt="Foto 1">
                    <img src="img/brisa2.jpeg" alt="Foto 2">
                    <img src="img/brisa3.jpeg" alt="Foto 3">
                    <img src="img/brisa4.jpeg" alt="Foto 4">
                    <img src="img/brisa5.jpeg" alt="Foto 5">
                    <img src="img/brisa6.jpeg" alt="Foto 6">
                    <img src="img/brisa10.jpeg" alt="Foto 7">
                    <img src="img/brisa8.jpeg" alt="Foto 8">
                    <img src="img/brisa9.jpeg" alt="Foto 9">
                    <img src="img/brisa7.jpeg" alt="Foto 10">
                    <img src="img/brisa11.jpeg" alt="Foto 11">
                    <img src="img/brisa12.jpeg" alt="Foto 12">
                </div>
            </div>
        </div>

        <!-- M칔SICA -->
        <audio id="musica" loop>
            <source src="musica/lordhuron.mp3" type="audio/mpeg">
            Tu navegador no soporta audio.
        </audio>

    </div>

    <script>
        const carta = document.getElementById("carta");
        const mensajeDiv = document.getElementById("mensaje");
        const fotos = document.querySelectorAll("#fotos img");
        const sobre = document.getElementById("sobre");
        const musica = document.getElementById("musica");
        const introText = document.getElementById("introText");

        const texto = `Hola mi amor... 游눏

쮺onoces lo que es la timidez de los 치rboles? Timidez la dicen al fen칩meno bot치nico que hace que la copa de los arboles no se choquen entre si. Timidez de los 치rboles es lo que hacen que esten simetricamente cerca pero no se toquen. Lo suficientemente cerca como para formar un paisaje, un camino en donde se cuela el sol y tambien la lluvia. Estan a su vez lo suficientemnete lejos para no meterse en asuntos ajenos. Una distancia perfecta, fria calculada. Quizas esa timidez entre los 치rboles sea posibles porque ellos nada saben de deseso, o intenciones segundas, o de mirar a la cara de otra persona fijo mientras te habla y no poder concentrarte porque empezas a pensar lo linda que est치. Quizas la timidez sea una buena estrategia para que la cercania del otro no irrumpa nuestro espacio. Sabemos de los lios que se arman cuando hay dos. Los arboles no saben de la energia atomica que causa rozarse las manos sin querer y por un rato desconocer cualquier logica de espacio y tiempo. Ellos nunca se tocan. Ah si, pero forman paisajes. En mi experiencia no es nada aconsejable seguir el compartamiento de los arboles de todos modos. Es verdad que mantener distancia hace que la vida se mantenga ordenada y no sea tan misteriosa. Pero la timidez, NO. La timidez nunca hizo nacer grandes historias. FELIZ D칈A. TE AMO UN MUNDO. Y TE ELIJO SIEMPRE.`;

        let i = 0;
        let fotoIndex = 0;
        let abierta = false;
        let mensajeTimeout;
        let fotoTimeout;

        function toggleCarta() {

            if (!abierta) {

                // Ocultar frase inicial
                introText.classList.add("oculto");

                // Mostrar carta
                carta.style.display = "flex";
                carta.style.pointerEvents = "auto";

                setTimeout(() => {
                    carta.classList.add("abierta");
                }, 50);

                musica.play();

                if (i === 0) escribirMensaje();

                if (fotoIndex === 0) {
                    fotos[0].style.setProperty('--index', 0);
                    fotos[0].classList.add('visible');
                    fotoIndex = 1;
                    fotoTimeout = setTimeout(mostrarFotosCascada, 2000);
                }

                abierta = true;

            } else {

                carta.classList.remove("abierta");

                musica.pause();
                musica.currentTime = 0;

                clearTimeout(mensajeTimeout);
                clearTimeout(fotoTimeout);

                fotos.forEach(img => img.classList.remove("visible"));

                setTimeout(() => {
                    carta.style.display = "none";
                    carta.style.pointerEvents = "none";
                    mensajeDiv.innerHTML = "";
                    i = 0;
                    fotoIndex = 0;

                    // Mostrar frase otra vez
                    introText.classList.remove("oculto");

                }, 500);

                abierta = false;
            }
        }

        function escribirMensaje() {
            if (i < texto.length) {
                mensajeDiv.innerHTML += texto.charAt(i);
                i++;
                mensajeTimeout = setTimeout(escribirMensaje, 60);
            }
        }

        function mostrarFotosCascada() {
            if (fotoIndex < fotos.length) {
                fotos[fotoIndex].style.setProperty('--index', fotoIndex);
                fotos[fotoIndex].classList.add('visible');
                fotoIndex++;
                fotoTimeout = setTimeout(mostrarFotosCascada, 2000);
            }
        }

        carta.addEventListener("click", toggleCarta);
        sobre.addEventListener("click", toggleCarta);

    </script>

</body>
</html>
