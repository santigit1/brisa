<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Para el amor de mi vida ðŸ’›</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="container">

        <!-- FRASE INICIAL -->
        <div class="intro-text" id="introText">
            <p>
                Un detalle chiquito, para que sepas<br>
                que siempre busco la forma<br>
                de sacarte una sonrisa<br>
                y recordarte lo importante que sos para mÃ­.
            </p>
        </div>

        <!-- SOBRE -->
        <div class="envelope" id="sobre"></div>

        <div class="text">
            Toca para abrir <span class="heart">ðŸ’›</span>
        </div>

        <!-- CARTA -->
        <div class="carta" id="carta">
            <div class="contenido">
                <div id="mensaje"></div>

                <div id="fotos">
                    <img src="img/brisa1.jpeg" alt="Foto 1">
                    <img src="img/brisa2.jpeg" alt="Foto 2">
                    <img src="img/brisa3.jpeg" alt="Foto 3">
                    <img src="img/brisa4.jpeg" alt="Foto 4">
                    <img src="img/brisa5.jpeg" alt="Foto 5">
                    <img src="img/brisa6.jpeg" alt="Foto 6">
                    <img src="img/brisa10.jpeg" alt="Foto 7">
                    <img src="img/brisa8.jpeg" alt="Foto 8">
                    <img src="img/brisa9.jpeg" alt="Foto 9">
                    <img src="img/brisa7.jpeg" alt="Foto 10">
                    <img src="img/brisa11.jpeg" alt="Foto 11">
                    <img src="img/brisa12.jpeg" alt="Foto 12">
                </div>
            </div>
        </div>

        <!-- MÃšSICA -->
        <audio id="musica" loop>
            <source src="musica/lordhuron.mp3" type="audio/mpeg">
            Tu navegador no soporta audio.
        </audio>

    </div>

    <script>
        const carta = document.getElementById("carta");
        const mensajeDiv = document.getElementById("mensaje");
        const fotos = document.querySelectorAll("#fotos img");
        const sobre = document.getElementById("sobre");
        const musica = document.getElementById("musica");
        const introText = document.getElementById("introText");

        const texto = `Hola mi amor... ðŸ’Œ

Â¿Conoces lo que es la timidez de los Ã¡rboles?

La timidez de los Ã¡rboles hace que estÃ©n cerca, pero que no se toquen.
Lo suficientemente cerca como para formar un paisaje,
pero lo suficientemente lejos como para no invadir.

QuizÃ¡s los Ã¡rboles no saben de deseos,
ni de lo que pasa cuando mirÃ¡s a alguien
y no podÃ©s concentrarte porque pensÃ¡s lo linda que estÃ¡.

Los Ã¡rboles nunca se tocan,
pero forman paisajes.

En mi experiencia,
la timidez nunca hizo nacer grandes historias.

FELIZ DÃA.
TE AMO UN MUNDO.
Y TE ELIJO SIEMPRE.`;

        let i = 0;
        let fotoIndex = 0;
        let abierta = false;
        let mensajeTimeout;
        let fotoTimeout;

        function toggleCarta() {

            if (!abierta) {

                // Ocultar frase inicial
                introText.classList.add("oculto");

                // Mostrar carta
                carta.style.display = "flex";
                carta.style.pointerEvents = "auto";

                setTimeout(() => {
                    carta.classList.add("abierta");
                }, 50);

                musica.play();

                if (i === 0) escribirMensaje();

                if (fotoIndex === 0) {
                    fotos[0].style.setProperty('--index', 0);
                    fotos[0].classList.add('visible');
                    fotoIndex = 1;
                    fotoTimeout = setTimeout(mostrarFotosCascada, 2000);
                }

                abierta = true;

            } else {

                carta.classList.remove("abierta");

                musica.pause();
                musica.currentTime = 0;

                clearTimeout(mensajeTimeout);
                clearTimeout(fotoTimeout);

                fotos.forEach(img => img.classList.remove("visible"));

                setTimeout(() => {
                    carta.style.display = "none";
                    carta.style.pointerEvents = "none";
                    mensajeDiv.innerHTML = "";
                    i = 0;
                    fotoIndex = 0;

                    // Mostrar frase otra vez
                    introText.classList.remove("oculto");

                }, 500);

                abierta = false;
            }
        }

        function escribirMensaje() {
            if (i < texto.length) {
                mensajeDiv.innerHTML += texto.charAt(i);
                i++;
                mensajeTimeout = setTimeout(escribirMensaje, 60);
            }
        }

        function mostrarFotosCascada() {
            if (fotoIndex < fotos.length) {
                fotos[fotoIndex].style.setProperty('--index', fotoIndex);
                fotos[fotoIndex].classList.add('visible');
                fotoIndex++;
                fotoTimeout = setTimeout(mostrarFotosCascada, 2000);
            }
        }

        carta.addEventListener("click", toggleCarta);
        sobre.addEventListener("click", toggleCarta);

    </script>

</body>
</html>
